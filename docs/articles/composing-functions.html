<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Composing Templates &amp; Functions • ggpackets</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Composing Templates &amp; Functions">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ggpackets</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ggpackets.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/composing-functions.html">Composing Templates &amp; Functions</a>
    </li>
    <li>
      <a href="../articles/inspection-and-documentation.html">Inspection &amp; Documentation</a>
    </li>
    <li>
      <a href="../articles/miscellaneous-examples.html">Miscellaneous Examples</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Composing Templates &amp; Functions</h1>
                        <h4 class="author">Doug Kelkhoff</h4>
            
            <h4 class="date">2018-03-30 21:39:59</h4>
      
      

    </div>

    
    
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h1>
<p><code>ggpackets</code> is most powerful when it’s being used to build template functions. By using it as a framework for packaging components of a ggplot into a single object, it provides a simple framework for constructing full featured ggplot wrappers. Most importantly, this will handle a wealth of ggplot-naitive parameters, exposing complete control over the components of a plot with minimal added syntax. That’s not to say there is no work to be done - to elegantly handle parameters intuitively and with minimal syntactic burden on the end user, there might be some amount of argument handling in order to satisfy the ideal user interface. The goal is to allow the programmer to focus on building around the usability of their function instead of the nuances of constructing plots and handling interactivity with the extensible ggplot ecosystem.</p>
</div>
<div id="composing-a-template" class="section level1">
<h1 class="hasAnchor">
<a href="#composing-a-template" class="anchor"></a>Composing a template</h1>
<p>First, before we get too far along, <code>ggpackets</code> is nearly useless without components from <code>ggplot2</code>. Let’s get that loaded.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)</code></pre></div>
<p>To build our first template, we’ll simply add a few layers to a <code>ggpacket</code> object. We’ll specify some aesthetic parameters - the size the line layer (<code><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line()</a></code>) and the point layer (<code><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point()</a></code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ggpk_my_template &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ggpacket-class.html">ggpacket</a></span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>(<span class="dt">size =</span> <span class="dv">3</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(Loblolly) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> age, <span class="dt">y =</span> height, <span class="dt">color =</span> Seed) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>ggpk_my_template <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">ggtitle</a></span>(<span class="st">'Growth of Loblolly Pines'</span>)</code></pre></div>
<p><img src="composing-functions_files/figure-html/simple_ggpacket_output-1.png" width="600px" height="400px" style="display: block; margin: auto;"></p>
<p>Although this might be helpful for making quick, reusable code, it does not provide much flexibility and is for all intents and purposes equivalent to <code>list(geom_line(size = 1), geom_point(size = 3))</code>. Perhaps the syntax is a little more familiar to those that use ggplot regularly, but aside from that, this simplist form provides very little real value.</p>
</div>
<div id="wrapping-a-template-in-a-function" class="section level1">
<h1 class="hasAnchor">
<a href="#wrapping-a-template-in-a-function" class="anchor"></a>Wrapping a template in a function</h1>
<p>Where the power of <code>ggpackets</code> begins to shine is in its transparent argument handling. If we want to bundle up our function above, but also want to provide optional handling of additional ggplot parameters, then ggpackets provides much of that functionality with very little additional syntax. Here we use the <code><a href="../reference/ggpack.html">ggpack()</a></code> function to articulate parameters to each layer and lump in any extra paramaters passed to our function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ggpk_my_template &lt;-<span class="st"> </span><span class="cf">function</span>(...) {
  <span class="kw"><a href="../reference/ggpack.html">ggpack</a></span>(geom_line, <span class="dt">size =</span> <span class="dv">1</span>, ...) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="../reference/ggpack.html">ggpack</a></span>(geom_point, <span class="dt">size =</span> <span class="dv">3</span>, ...)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(Loblolly) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> age, <span class="dt">y =</span> height) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggpk_my_template</span>(<span class="dt">stat =</span> <span class="st">'summary'</span>, <span class="dt">color =</span> age, <span class="dt">fun.data =</span> mean_se, <span class="dt">size =</span> <span class="dv">5</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">ggtitle</a></span>(<span class="st">'Average Growth of Loblolly Pines'</span>)</code></pre></div>
<p><img src="composing-functions_files/figure-html/function_ggpacket_output-1.png" width="600px" height="400px" style="display: block; margin: auto;"></p>
<p>In the function we declared above, all arguments passed to our wrapper function get filter down into all the internal layers. When we pass through the <code>...</code>, we pass through any unnamed arguments from the parent function.</p>
<p>In fact, when we call the function, we can pass any arguments that would typically get passed to either of the ggplot functions wrapped inside of it, <code>geom_line</code> and <code>geom_point</code>. If we choose to pass both the <code>data</code> and <code>mapping</code> parameters (typically set using the <code><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot()</a></code> and <code><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes()</a></code> functions when constructing a ggplot object), we could even use this as a standalone function as shown below.</p>
<blockquote>
<p>Be aware that this usage isn’t particularly intuitive without a bit of added documentation. If you’re building a function for someone else to use or to export from a package you’re making, it’s probably worth writing up some good documentation about what parameters you expect people to use.</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggpk_my_template</span>(<span class="dt">data =</span> Loblolly, <span class="dt">x =</span> age, <span class="dt">y =</span> height, <span class="dt">color =</span> Seed)</code></pre></div>
<p><img src="composing-functions_files/figure-html/function_ggpacket_standalone_output-1.png" width="600px" height="400px" style="display: block; margin: auto;"></p>
</div>
<div id="granular-parameter-passing" class="section level1">
<h1 class="hasAnchor">
<a href="#granular-parameter-passing" class="anchor"></a>Granular Parameter Passing</h1>
<p>There is one lingering issue. In this case, all parameters are being passed to both of the ggplot layers wrapped inside of our function. You can see the impact of this issue above, because both the size (thickness) of the lines and the size (diameter) of the points changed when we set a new size. If we want to control one or the other independently, we need a more precise way of passing parameters. This can be addressed by adding an identifying string to each of our layers using the <code>id</code> parameter to <code><a href="../reference/ggpack.html">ggpack()</a></code>.</p>
<p>If we want to restrict parameters to only one layer or another, <code>ggpackets</code> can handle the filtering of parameters through to each of the layers by parsing the parameters for prefixes that match that particular layer’s <code>id</code>. For example, if a layer has an <code>id = 'my_ggplot_layer'</code>, then we might pass the function a parameter like <code>my_ggplot_layer.size</code> (the id and parameter name separated by a period) to set the size parameter of that particular layer without affecting the others.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ggpk_my_template &lt;-<span class="st"> </span><span class="cf">function</span>(...) {
  <span class="kw"><a href="../reference/ggpack.html">ggpack</a></span>(geom_line, <span class="dt">id =</span> <span class="st">'line'</span>, <span class="dt">size =</span> <span class="dv">1</span>, ...) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/ggpack.html">ggpack</a></span>(geom_point, <span class="dt">id =</span> <span class="st">'point'</span>, <span class="dt">size =</span> <span class="dv">3</span>, ...)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(Loblolly) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> age, <span class="dt">y =</span> height, <span class="dt">color =</span> Seed) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggpk_my_template</span>(<span class="dt">point.size =</span> <span class="dv">5</span>, <span class="dt">line.size =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">ggtitle</a></span>(<span class="st">'Average Growth of Loblolly Pines'</span>)</code></pre></div>
<p><img src="composing-functions_files/figure-html/granular_ggpacket_output-1.png" width="600px" height="400px" style="display: block; margin: auto;"></p>
<p>Lists are also permitted as an <code>id</code>, allowing for any one of a number of different prefixes to capture arguments for a particular layer.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ggpk_my_template &lt;-<span class="st"> </span><span class="cf">function</span>(...) {
  <span class="kw"><a href="../reference/ggpack.html">ggpack</a></span>(geom_line, <span class="dt">id =</span> <span class="kw">c</span>(<span class="st">'all'</span>, <span class="st">'line'</span>), <span class="dt">size =</span> <span class="dv">1</span>, ...) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/ggpack.html">ggpack</a></span>(geom_point, <span class="dt">id =</span> <span class="kw">c</span>(<span class="st">'all'</span>, <span class="st">'point'</span>), <span class="dt">size =</span> <span class="dv">3</span>, ...)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(Loblolly) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> age, <span class="dt">y =</span> height) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggpk_my_template</span>(<span class="dt">all.stat =</span> <span class="st">'summary'</span>, <span class="dt">all.fun.data =</span> mean_se,
    <span class="dt">point.size =</span> <span class="dv">5</span>, <span class="dt">line.size =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">ggtitle</a></span>(<span class="st">'Average Growth of Loblolly Pines'</span>)</code></pre></div>
<p><img src="composing-functions_files/figure-html/granular_ggpacket_output2-1.png" width="600px" height="400px" style="display: block; margin: auto;"></p>
</div>
<div id="default-user-and-fixed-parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#default-user-and-fixed-parameters" class="anchor"></a>Default, User and Fixed Parameters</h1>
<p>The ordering of the parameters passed to any layer carries its own significance and can be used to exercise further control over how your function operates. If a parameter is passed to the layer more than once, the last instance always takes priority. This includes parameters passed as a list via the <code>dots</code> parameter. This allows calls to be constructed in a way that dictates which arguments are set in stone and which can be ovewritten by the user.</p>
<p>Take for example the following function where all ellipses parameters are passed through to the layers using the <code>dots</code> parameter. In the first layer, <code>size</code> is declared before the parameters passed in by the user, whereas the second has <code>size</code> passed after the user parameters.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ggpk_my_template &lt;-<span class="st"> </span><span class="cf">function</span>(...) {
  <span class="kw"><a href="../reference/ggpack.html">ggpack</a></span>(geom_line, <span class="dt">id =</span> <span class="st">'line'</span>, <span class="dt">size =</span> <span class="dv">3</span>, ...) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/ggpack.html">ggpack</a></span>(geom_point, <span class="dt">id =</span> <span class="st">'point'</span>, ..., <span class="dt">size =</span> <span class="dv">3</span>)
}</code></pre></div>
<p>The user will be able to set the size of the line layer, but will be unable to change the size of the point layer because the last <code>size</code> parameter will always take precedent (even if it’s passed with a prefix, like <code>point.size</code>). This gives considerable control over what impact the user can have over the plot template.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(Loblolly) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> age, <span class="dt">y =</span> height, <span class="dt">color =</span> Seed) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggpk_my_template</span>(<span class="dt">line.size =</span> <span class="fl">0.1</span>, <span class="dt">point.size =</span> <span class="dv">10</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">ggtitle</a></span>(<span class="st">'Average Growth of Loblolly Pines'</span>)</code></pre></div>
<p><img src="composing-functions_files/figure-html/parameters_ggpacket_output-1.png" width="600px" height="400px" style="display: block; margin: auto;"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#overview">Overview</a></li>
      <li><a href="#composing-a-template">Composing a template</a></li>
      <li><a href="#wrapping-a-template-in-a-function">Wrapping a template in a function</a></li>
      <li><a href="#granular-parameter-passing">Granular Parameter Passing</a></li>
      <li><a href="#default-user-and-fixed-parameters">Default, User and Fixed Parameters</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Doug Kelkhoff.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
